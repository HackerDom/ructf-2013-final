0) CONFIG_CFQ_GROUP_IOSCHED=y
CONFIG_BLK_DEV_THROTTLING=y
0.1) Latest kernel
1) квоты
1.1) rc-update add quota boot
1.2) /usr/sbin/quotacheck -avugm
1.3) RUN_QUOTACHECK="no" в /etc/conf.d/quota
1.4) edquota , limit 1000000, inode 100000
1.5) quota user 2gb, rest 1gb
1.6) quota user database mr ses dns proxy queue
2) cgroups для каждого сервиса
2.1) pam_cgroups в system-auth и start-stop-daemon
2.2) session optional pam_cgroup.so
2.3) rc-update add cgconfig
3) init-скрипты
4) права в /home

6.3) export SYBASE="/usr"
6.4) g-cpan -i MongoDB
su user -s /bin/bash
cd
mkdir mongodb mongodb/run mongodb/db mongodb/log
rc-update add mongodb_user

7.1) use ithreads
8) services:
user(10000) Users API (and)
database(10001) Database API ? (umineko & krait, C++)
mr(10002) MapReduce (Егор, erlang)
ses(10003) Simple Email Service (dimmo, perl)
dns(10004) Cache DNS (lena, ruby)
proxy(10005) TCP Balancer (kost, C)
queue(10006) Message Queue (bay, rust)
Script API (andgein, PHP)
9) python2 by default

10) nginx.conf, rc-update add nginx default
mkdir -p /var/lib/overlays/cpan/
PORTDIR_OVERLAY="/var/lib/overlays/cpan/"

------------------------ SERVICE DEPLOYMENT ------------------------

=== user service ===
chown -R user:user /home/user
chmod +x /etc/init.d/user /etc/init.d/mongodb_user

g-cpan -i Mojolicious
g-cpan -i MongoDB

rc-update add user
rc-update add mongodb_user


=== database service ===
chown -R database:database /home/database
chmod +x /etc/init.d/database

rc-update add database


=== mr service ===
chown -R mr:mr /home/mr
chmod +x /etc/init.d/mr

rc-update add mr


=== ses service ===
chown -R ses:ses /home/ses
chmod +x /etc/init.d/ses_http /etc/init.d/ses_smtp

# В /etc/postfix/main.cf раскомментировать строку mynetworks_style = host
# В /etc/postfix/main.cf раскомментировать строку home_mailbox = Maildir/


rc-update add ses

=== dns service ===
chown -R dns:dns /home/dns
chmod +x /etc/init.d/dns

mysql_install_db --user=dns --datadir=/home/dns/mysql/db/ --skip-name-resolve --defaults-file=/home/dns/mysql/my.cnf

rc-update add dns
rc-update add dns_web
rc-update add mysql_dns

=== queue service ===
chown -R queue:queue /home/queue
chmod +x /etc/init.d/queue /etc/init.d/queue_web

rc-update add queue
rc-update add queue_web

